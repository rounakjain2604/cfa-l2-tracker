<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LM1: Multiple Regression | CFA L2</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Mali:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">

    <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}]});"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --bg: #F8F6F3;
            --paper: #FFFEF9;
            --ink: #0D0D0D;
            --ink-light: #555555;
            --accent: #6C5CE7;
            --teal: #00B894;
            --coral: #FF4B2B;
            --hl-yellow: rgba(253, 203, 110, 0.55);
            --hl-pink: rgba(253, 167, 167, 0.5);
            --hl-green: rgba(129, 236, 168, 0.5);
            --hl-purple: rgba(162, 155, 254, 0.5);
            --border: #E8E4E0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Mali', cursive;
            background-color: var(--bg);
            background-image:
                linear-gradient(rgba(13, 13, 13, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(13, 13, 13, 0.03) 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--ink);
            font-size: 15px;
            line-height: 1.65;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .header {
            background: var(--paper);
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .header h1 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--coral);
            margin-bottom: 4px;
        }

        .header p {
            font-size: 0.75rem;
            color: var(--ink-light);
        }

        .nav-pills {
            display: flex;
            gap: 8px;
            padding: 12px 16px;
            overflow-x: auto;
            background: var(--paper);
            border-bottom: 1px solid var(--border);
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .nav-pills::-webkit-scrollbar {
            display: none;
        }

        .nav-pill {
            flex-shrink: 0;
            padding: 8px 14px;
            font-size: 0.8rem;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            background: white;
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--ink-light);
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-pill.active {
            background: var(--coral);
            border-color: var(--coral);
            color: white;
        }

        .content {
            padding: 20px;
            max-width: 100%;
            background: var(--paper);
            min-height: calc(100vh - 120px);
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            font-size: 1.15rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 2px solid var(--coral);
        }

        h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent);
            margin: 18px 0 10px;
        }

        h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--ink);
            margin: 14px 0 8px;
        }

        p {
            margin-bottom: 12px;
            word-wrap: break-word;
        }

        ul,
        ol {
            margin: 0 0 12px 20px;
        }

        li {
            margin-bottom: 6px;
        }

        .hl {
            background: var(--hl-yellow);
            padding: 1px 4px;
            border-radius: 3px;
        }

        .hl-pink {
            background: var(--hl-pink);
            padding: 1px 4px;
            border-radius: 3px;
        }

        .hl-green {
            background: var(--hl-green);
            padding: 1px 4px;
            border-radius: 3px;
        }

        .hl-purple {
            background: var(--hl-purple);
            padding: 1px 4px;
            border-radius: 3px;
        }

        .formula-box {
            background: linear-gradient(135deg, #F5F3FF 0%, #E8E5FF 100%);
            border: 2px solid var(--accent);
            border-radius: 10px;
            padding: 14px 16px;
            margin: 14px 0;
            text-align: center;
            overflow-x: auto;
            /* Prevent overflow */
            max-width: 100%;
            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE 10+ */
        }

        .formula-box::-webkit-scrollbar {
            display: none;
            /* Chrome/Safari */
        }

        .formula-box .label {
            font-family: 'Inter', sans-serif;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .formula-box .formula {
            font-size: 1rem;
            font-weight: 700;
            color: var(--ink);
            word-break: break-all;
            white-space: normal;
        }

        /* Responsive Tables - No Scroll, Stacked on Mobile */
        .table-wrap {
            width: 100%;
            margin: 12px 0;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.85rem;
        }

        @media (max-width: 600px) {

            table,
            thead,
            tbody,
            th,
            td,
            tr {
                display: block;
            }

            thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }

            tr {
                margin-bottom: 12px;
                border: 1px solid var(--border);
                border-radius: 8px;
                background: white;
                padding: 8px;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03);
            }

            td {
                border: none;
                border-bottom: 1px dashed var(--border);
                position: relative;
                padding: 8px 0 8px 35%;
                text-align: right;
                min-height: 36px;
            }

            td:last-child {
                border-bottom: none;
            }

            td::before {
                position: absolute;
                top: 8px;
                left: 0;
                width: 30%;
                padding-right: 10px;
                white-space: nowrap;
                text-align: left;
                font-weight: 700;
                color: var(--ink-light);
                content: attr(data-label);
                font-family: 'Inter', sans-serif;
                font-size: 0.75rem;
            }

            tr:nth-child(even) td {
                background: transparent;
            }
        }

        .svg-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }

        .svg-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }

        .svg-card svg {
            width: 100%;
            height: auto;
            max-width: 150px;
        }

        .svg-label {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--ink-light);
            margin-top: 6px;
        }

        .svg-label.bad {
            color: var(--coral);
        }

        .svg-label.good {
            color: var(--teal);
        }


        .note.warn {
            background: #FFF5F3;
            border-left-color: var(--coral);
        }

        .note.info {
            background: #F5F3FF;
            border-left-color: var(--accent);
        }

        .note-title {
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
            color: var(--ink);
        }

        .note p {
            margin-bottom: 4px;
            font-size: 0.9rem;
        }

        .table-wrap {
            width: 100%;
            margin: 12px 0;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.85rem;
        }

        th {
            background: #5D4E9E;
            color: white;
            padding: 10px 12px;
            text-align: left;
            font-family: 'Inter', sans-serif;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border);
            vertical-align: top;
            background: white;
        }

        tr:nth-child(even) td {
            background: #FAFAFA;
        }

        .card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 14px 16px;
            margin: 12px 0;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
        }

        .example {
            background: linear-gradient(135deg, #FFF9F0 0%, #FFF5E8 100%);
            border: 1px solid #F0D9B5;
            border-radius: 10px;
            padding: 14px 16px;
            margin: 14px 0;
            overflow-x: auto;
        }

        .example-title {
            font-size: 0.8rem;
            font-weight: 700;
            color: #C0792A;
            margin-bottom: 10px;
        }

        .key-point {
            background: linear-gradient(135deg, #FFF5F0 0%, #FFECE8 100%);
            border-left: 3px solid var(--coral);
            border-radius: 0 8px 8px 0;
            padding: 12px 14px;
            margin: 12px 0;
        }

        .key-point::before {
            content: "üí° KEY";
            display: block;
            font-family: 'Inter', sans-serif;
            font-size: 0.65rem;
            font-weight: 700;
            color: var(--coral);
            margin-bottom: 6px;
        }

        .exam-tip {
            background: #F0FFF8;
            border-left: 3px solid var(--teal);
            border-radius: 0 8px 8px 0;
            padding: 12px 14px;
            margin: 12px 0;
        }

        .exam-tip::before {
            content: "üìù EXAM TIP";
            display: block;
            font-family: 'Inter', sans-serif;
            font-size: 0.65rem;
            font-weight: 700;
            color: var(--teal);
            margin-bottom: 6px;
        }

        .trap {
            background: #FFF5F3;
            border-left: 3px solid var(--coral);
            border-radius: 0 8px 8px 0;
            padding: 12px 14px;
            margin: 12px 0;
        }

        .trap::before {
            content: "‚ö†Ô∏è EXAM TRAP";
            display: block;
            font-family: 'Inter', sans-serif;
            font-size: 0.65rem;
            font-weight: 700;
            color: var(--coral);
            margin-bottom: 6px;
        }

        code {
            background: #F5F3FF;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            color: var(--accent);
        }

        .flow-diagram {
            background: white;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px;
            margin: 14px 0;
        }

        .flow-step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px dashed var(--border);
        }

        .flow-step:last-child {
            border-bottom: none;
        }

        .flow-num {
            background: var(--accent);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .flow-text {
            flex: 1;
            font-size: 0.9rem;
        }

        .footer-spacer {
            height: 80px;
        }

        sub,
        sup {
            font-size: 0.7em;
        }
    </style>
</head>

<body>

    <header class="header">
        <h1>üìê LM 1: Multiple Regression Basics</h1>
        <p>Quantitative Methods ‚Ä¢ CFA Level II</p>
    </header>

    <nav class="nav-pills">
        <button class="nav-pill active" data-section="overview">Overview</button>
        <button class="nav-pill" data-section="equation">Equation</button>
        <button class="nav-pill" data-section="interpret">Interpret</button>
        <button class="nav-pill" data-section="assumptions">Assumptions</button>
        <button class="nav-pill" data-section="diagnostics">Diagnostics</button>
        <button class="nav-pill" data-section="output">Output</button>
        <button class="nav-pill" data-section="traps">Traps</button>
        <button class="nav-pill" data-section="practice">Practice</button>
    </nav>

    <main class="content">

        <!-- OVERVIEW -->
        <section class="section active" id="overview">
            <h2>üìå What is Multiple Regression?</h2>

            <div class="note info">
                <div class="note-title">üß† The Intuition: The "House Price" Analogy</div>
                <p>Imagine you are a real estate agent trying to price a house. You wouldn't just look at one factor,
                    right?</p>
                <p>If you only looked at <strong>Square Footage</strong> ($X_1$), you might overprice a huge rundown
                    lovely barn or underprice a tiny luxury penthouse. You need more clues.</p>
                <p><strong>Multiple Regression</strong> is simply the mathematical way of saying: "The price of this
                    house ($Y$) is a Base Value ($\beta_0$) plus a premium for Size ($X_1$), minus a penalty for Age
                    ($X_2$), plus a bonus for having a Pool ($X_3$)."</p>
                <p>It allows you to weigh multiple evidence streams simultaneously to get a single, precise prediction.
                </p>
            </div>

            <p>In finance, we do the exact same thing. Instead of House Prices, we predict <strong>Stock
                    Returns</strong>. Instead of Square Footage, we use <strong>P/E Ratio</strong>. Instead of Age, we
                use <strong>Interest Rates</strong>.</p>

            <h3>Why "Multiple" Matters?</h3>
            <p>Simple regression (one variable) is often too blunt. It assumes a single cause for complex events.
                Multiple regression allows for <strong>ceteris paribus</strong> analysis ‚Äî "all else equal."</p>
            <p>It lets us answer specific questions like: <em>"If inflation goes up by 1%, but GDP stays flat, what
                    happens to my portfolio?"</em> A simple model couldn't tell you that because it can't separate
                Inflation from GDP.</p>
            <h3>The Regression Process: A "Chef's Workflow"</h3>
            <div class="note info">
                <div class="note-title">üë®‚Äçüç≥ Analogy: Cooking a Michelin Goal</div>
                <p>Running a regression is like cooking a high-stakes meal. You have a process you must follow:</p>
            </div>

            <div class="flow-diagram">
                <div class="flow-step">
                    <span class="flow-num">1</span>
                    <div class="flow-text">
                        <strong>Check Ingredients (Continuous Y?)</strong>
                        <p style="margin:4px 0 0 0; font-size:0.85rem; color:var(--ink-light);">You can't make a soup
                            with a rock. Your target ($Y$) must be a number that moves (Example: Returns), not a binary
                            "Yes/No". If it's binary, stop. Use Logistic Regression.</p>
                    </div>
                </div>
                <div class="flow-step">
                    <span class="flow-num">2</span>
                    <div class="flow-text">
                        <strong>Write the Recipe (Specify Model)</strong>
                        <p style="margin:4px 0 0 0; font-size:0.85rem; color:var(--ink-light);">Decide what inputs
                            ($X$s) belong in the pot. Inflation? GDP? P/E? (Don't just throw in everything; that's
                            "Kitchen Sink" regression, and it tastes bad).</p>
                    </div>
                </div>
                <div class="flow-step">
                    <span class="flow-num">3</span>
                    <div class="flow-text">
                        <strong>Let the Oven Work (Estimate)</strong>
                        <p style="margin:4px 0 0 0; font-size:0.85rem; color:var(--ink-light);">Feed data into software
                            (Excel/Python). It finds the line of best fit that minimizes mistakes (SSE).</p>
                    </div>
                </div>
                <div class="flow-step">
                    <span class="flow-num">4</span>
                    <div class="flow-text">
                        <strong>Taste Test (Check Assumptions)</strong>
                        <p style="margin:4px 0 0 0; font-size:0.85rem; color:var(--ink-light);"><strong>CRITICAL
                                STEP.</strong> Check the residuals. Is there a weird aftertaste? (Serial correlation?).
                            Is the texture uneven? (Heteroskedasticity?). If yes, fix it before serving.</p>
                    </div>
                </div>
                <div class="flow-step">
                    <span class="flow-num">5</span>
                    <div class="flow-text">
                        <strong>Critic Review (Hypothesis Testing)</strong>
                        <p style="margin:4px 0 0 0; font-size:0.85rem; color:var(--ink-light);">Does the meal actually
                            taste like anything? (Is $F$-stat significant?). Does the salt matter? (Is $t$-stat
                            significant?).</p>
                    </div>
                </div>
                <div class="flow-step">
                    <span class="flow-num">6</span>
                    <div class="flow-text">
                        <strong>Serve (Prediction)</strong>
                        <p style="margin:4px 0 0 0; font-size:0.85rem; color:var(--ink-light);">Only if Step 4 & 5 pass,
                            use the model to predict the future.</p>
                    </div>
                </div>
            </div>

            <div class="trap">
                <strong>‚ö†Ô∏è MAJOR EXAM TRAP</strong><br>
                Never use Linear Regression for a <strong>Binary Dependent Variable</strong> (e.g., Will the company
                default? Yes/No).
                <br>This violates the assumption that $Y$ is continuous. You must answer "Logistic Regression" or
                "Probit/Logit" for these cases.
            </div>
        </section>

        <!-- EQUATION -->
        <section class="section" id="equation">
            <h2>üìê The Multiple Regression Equation</h2>

            <div class="formula-box">
                <div class="label">General Form Breakdown</div>
                <div class="formula">$$Y_i = \underbrace{\beta_0 + \beta_1 X_{1i} + \cdots + \beta_k
                    X_{ki}}_{\text{Predicted Part}} + \underbrace{\varepsilon_i}_{\text{Error Part}}$$</div>
                <div class="desc">We predict the first part. The second part is pure luck/noise.</div>
            </div>

            <p>Let's break down <strong>every single symbol</strong> so there is zero confusion:</p>

            <div class="card">
                <h4>1. The "Y" (Dependent Variable)</h4>
                <p>This is what you want to guess. It's the <em>result</em>. In finance, it's usually Stock Returns, GDP
                    Growth, or Default Risk.</p>
                <p><strong>Rule:</strong> It must be continuous (meaning it can be 1.5%, 1.51%, 1.52%...). It cannot be
                    a simple "Yes/No".</p>

                <h4>2. The "X"s (Independent Variables)</h4>
                <p>These are your clues. The raw data you feed the model. $X_1$ might remain inflation, $X_2$ might be
                    oil prices.</p>
                <p><strong>Rule:</strong> You need at least two "clues" for it to be <em>Multiple</em> Regression.
                    Otherwise, it's just Simple Regression.</p>

                <h4>3. The Betas ($\beta$) (Coefficients)</h4>
                <p>These are the "weights" or "multipliers". The model calculates these for you. They tell you <em>how
                        much</em> each clue matters.</p>
                <ul>
                    <li>If $\beta_1$ is huge, $X_1$ is a major driver.</li>
                    <li>If $\beta_1$ is near zero, $X_1$ is irrelevant noise.</li>
                </ul>

                <h4>4. The Epsilon ($\varepsilon$) (Error Term)</h4>
                <p>This is the "unknown." No model is perfect. There is always some random event‚Äîa CEO scandal, a
                    natural disaster, a tweet‚Äîthat math cannot predict. We call this the Error Term.</p>
            </div>

            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Term</th>
                            <th>Meaning</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Term">$Y_i$</td>
                            <td data-label="Meaning">Dependent Variable</td>
                        </tr>
                        <tr>
                            <td data-label="Term">$\beta_0$</td>
                            <td data-label="Meaning">Intercept</td>
                        </tr>
                        <tr>
                            <td data-label="Term">$\beta_j$</td>
                            <td data-label="Meaning">Slope Coefficient</td>
                        </tr>
                        <tr>
                            <td data-label="Term">$\varepsilon_i$</td>
                            <td data-label="Meaning">Error Term</td>
                        </tr>
                        <tr>
                            <td data-label="Term">$k$</td>
                            <td data-label="Meaning"># Independent Vars</td>
                        </tr>
                        <tr>
                            <td data-label="Term">$n$</td>
                            <td data-label="Meaning">Sample Size</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Deterministic vs. Stochastic</h3>
            <div class="card">
                <ul>
                    <li><strong>Deterministic part:</strong> $\beta_0 + \beta_1 X_1 + \cdots + \beta_k X_k$ ‚Äî the
                        explained portion</li>
                    <li><strong>Stochastic part:</strong> $\varepsilon_i$ ‚Äî random, unexplained variation</li>
                </ul>
            </div>
        </section>

        <!-- INTERPRET -->
        <section class="section" id="interpret">
            <h2>üîç Interpreting Coefficients</h2>

            <p>This is the most critical skill for the exam. You must be able to translate the math into a plain-English
                story.</p>

            <h3>The Intercept ($\beta_0$): The "Anchor"</h3>
            <div class="card">
                <p><strong>Definition:</strong> The expected value of $Y$ when ALL independent variables are equal to
                    zero.</p>
                <hr style="border-top:1px dashed var(--border); margin:10px 0;">
                <p><strong>Why do we need it?</strong></p>
                <p>Imagine trying to predict a person's weight based on their height. If height is 0, does that mean
                    weight is 0? Mathematically, yes. But in reality, a human has a "base weight" just by existing. The
                    Intercept provides this baseline.</p>
                <p><strong>Example:</strong> In a regression of Portfolio Returns vs. Market Returns ($R_p = \alpha +
                    \beta R_m$), the intercept is <strong>Alpha</strong>. It's the return you get usually just for
                    showing up, even if the market does nothing ($R_m = 0$).</p>
                <div class="note warn">
                    <p><strong>Warning:</strong> Sometimes the intercept makes no physical sense (e.g., a house with 0
                        sqft costing $50k). That's okay. It's often just a mathematical anchor to make the line fit
                        better. Don't force a real-world meaning if there isn't one.</p>
                </div>
            </div>

            <h3>Slope Coefficients ($\beta_1, \beta_2, \ldots$): The "Sensitivity"</h3>

            <div class="note tip">
                <div class="note-title">üß™ The "Control Group" Analogy</div>
                <p>Imagine you have two identical twins. They eat the exact same diet, sleep the exact same hours, and
                    have the exact same genetics.</p>
                <p>But... you give Twin A a caffeine pill ($X_1$) and Twin B a placebo.</p>
                <p>If Twin A runs 5mph faster, you know that <strong>holding everything else constant</strong> (diet,
                    sleep, genes), caffeine adds 5mph.</p>
                <p>That is what $\beta_1$ is. It isolates the effect of <em>just one variable</em> by mathematically
                    freezing the others.</p>
            </div>

            <div class="key-point">
                <strong>THE GOLDEN RULE:</strong> You must always include the phrase <span class="hl">"holding all other
                    independent variables constant"</span>. Without this, your interpretation is wrong because in the
                real world, variables often move together.
            </div>
            <div class="example">
                <div class="example-title">üìä Bond Index Returns</div>
                <p>$$\text{RET} = 0.0023 - 5.0585 \cdot \text{BY} - 2.1901 \cdot \text{CS}$$</p>
                <ul>
                    <li><strong>Intercept (0.0023):</strong> ~0.028% annual return if bond yields and credit spreads
                        don't change</li>
                    <li><strong>BY coef (‚àí5.0585):</strong> 1% ‚Üë in govt bond yield ‚Üí 5.06% ‚Üì in returns, <em>holding CS
                            constant</em></li>
                    <li><strong>CS coef (‚àí2.1901):</strong> 1% ‚Üë in credit spreads ‚Üí 2.19% ‚Üì in returns, <em>holding BY
                            constant</em></li>
                </ul>
            </div>

            <h3>Making Predictions</h3>
            <div class="formula-box">
                <div class="label">Predicted Value</div>
                <div class="formula">$$\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X_1 + \hat{\beta}_2 X_2 + \cdots$$</div>
            </div>

            <div class="example">
                <div class="example-title">üìä Calculate Portfolio Return</div>
                <p>Model: $\text{RETRF} = 1.53 + 0.59 \cdot \text{MKTRF} - 0.87 \cdot \text{SMB} - 0.06 \cdot
                    \text{HML}$</p>
                <p>Given: MKTRF = 1, SMB = 4, HML = ‚àí2</p>
                <p>$$\hat{Y} = 1.53 + 0.59(1) - 0.87(4) - 0.06(-2) = \boxed{-1.25\%}$$</p>
            </div>
        </section>

        <!-- ASSUMPTIONS -->
        <section class="section" id="assumptions">
            <h2>‚ö†Ô∏è The 5 Assumptions (The "Uber App" Analogy)</h2>

            <div class="note info">
                <div class="note-title">üöï The Unified Analogy</div>
                <p><strong>Stop thinking about math.</strong> Imagine you are building the pricing algorithm for Uber.
                </p>
                <p>Your goal is to predict the <strong>Fare ($Y$)</strong> based on <strong>Distance ($X$)</strong>.</p>
                <p>The "Assumptions" are just the 5 rules required for your app to work fairly. If you break them, the
                    app crashes or rips people off.</p>
            </div>

            <div class="svg-container">
                <div class="svg-card">
                    <svg viewBox="0 0 100 80">
                        <line x1="10" y1="70" x2="90" y2="10" stroke="#00B894" stroke-width="2" />
                        <circle cx="20" cy="65" r="2" fill="#555" />
                        <circle cx="30" cy="55" r="2" fill="#555" />
                        <circle cx="50" cy="40" r="2" fill="#555" />
                        <circle cx="70" cy="25" r="2" fill="#555" />
                        <circle cx="80" cy="15" r="2" fill="#555" />
                    </svg>
                    <div class="svg-label good">Linearity (Good)</div>
                </div>
                <div class="svg-card">
                    <svg viewBox="0 0 100 80">
                        <path d="M10,20 Q50,90 90,20" fill="none" stroke="#FF4B2B" stroke-width="2"
                            stroke-dasharray="4" />
                        <circle cx="15" cy="25" r="2" fill="#555" />
                        <circle cx="30" cy="50" r="2" fill="#555" />
                        <circle cx="50" cy="70" r="2" fill="#555" />
                        <circle cx="70" cy="50" r="2" fill="#555" />
                        <circle cx="85" cy="25" r="2" fill="#555" />
                    </svg>
                    <div class="svg-label bad">Non-Linear (Bad)</div>
                </div>
            </div>

            <div class="card">
                <h4>1. Linearity: "The Fair Meter Rule"</h4>
                <div class="svg-container">
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-lin-good"></canvas>
                        <div class="svg-label good">Linear (Good)</div>
                    </div>
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-lin-bad"></canvas>
                        <div class="svg-label bad">Curved (Bad)</div>
                    </div>
                </div>
                <p><strong>The Rule (Analogy):</strong> Driving further should cost more (Straight Line).</p>
                <p><strong>The Bookish Definition (Formal):</strong> The relationship between the dependent variable
                    ($Y$) and independent variables ($X_k$) is linear in the coefficients ($ \beta_k $).</p>
                <div class="note tip" style="margin-top:8px; font-size:0.9rem;">
                    <strong>Exam Note:</strong> "Linear in parameters" means you can't have $\beta^2$. But you CAN have
                    $X^2$ (which is just a transformed variable).
                </div>
            </div>

            <div class="card">
                <h4>2. Homoskedasticity: "The Economy vs. Luxury Rule"</h4>
                <div class="svg-container">
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-hom-good"></canvas>
                        <div class="svg-label good">Consistent Accuracy (Good)</div>
                    </div>
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-hom-bad"></canvas>
                        <div class="svg-label bad">Wild Guessing (Bad)</div>
                    </div>
                </div>
                <p><strong>The Rule (Analogy):</strong> Reliable accuracy for both short and long rides.</p>
                <p><strong>The Bookish Definition (Formal):</strong> The variance of the error term ($\varepsilon$) is
                    constant for all observations. $\text{Var}(\varepsilon_i) = \sigma^2$.</p>
                <div class="note tip" style="margin-top:8px; font-size:0.9rem;">
                    <strong>Exam Translaction:</strong> "Homoskedastic" = Equal Variance. "Heteroskedastic" = Different
                    Variance (Bad).
                </div>
            </div>

            <div class="card">
                <h4>3. Independence: "The Fresh Start Rule"</h4>
                <div class="svg-container">
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-ind-good"></canvas>
                        <div class="svg-label good">Random (Good)</div>
                    </div>
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-ind-bad"></canvas>
                        <div class="svg-label bad">Pattern (Bad)</div>
                    </div>
                </div>
                <p><strong>The Rule (Analogy):</strong> One bad trip shouldn't effectively guarantee the next one is bad
                    too.</p>
                <p><strong>The Bookish Definition (Formal):</strong> The error term $\varepsilon_i$ is uncorrelated
                    across observations. $E[\varepsilon_i \varepsilon_j] = 0$ for $i \neq j$.</p>
                <div class="note tip" style="margin-top:8px; font-size:0.9rem;">
                    <strong>Exam Synonym:</strong> "No Serial Correlation" or "No Autocorrelation".
                </div>
            </div>

            <div class="card">
                <h4>4. Normality: "The No-Disasters Rule"</h4>
                <div class="svg-container">
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-norm-good"></canvas>
                        <div class="svg-label good">Bell Curve (Good)</div>
                    </div>
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-norm-bad"></canvas>
                        <div class="svg-label bad">Disasters (Bad)</div>
                    </div>
                </div>
                <p><strong>The Rule (Analogy):</strong> Most errors are small; huge pricing anomalies are impossible.
                </p>
                <p><strong>The Bookish Definition (Formal):</strong> The error term $\varepsilon$ is normally
                    distributed with a mean of zero. $\varepsilon \sim N(0, \sigma^2)$.</p>
                <div class="note tip" style="margin-top:8px; font-size:0.9rem;">
                    <strong>Exam Note:</strong> This is critical for <strong>T-Tests</strong> to work. If errors aren't
                    normal, your T-stats are fake news.
                </div>
            </div>

            <div class="card">
                <h4>5. No Multicollinearity: "The Double-Counting Rule"</h4>
                <div class="svg-container">
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-mul-good"></canvas>
                        <div class="svg-label good">Distinct (Good)</div>
                    </div>
                    <div class="svg-card" style="height:120px;">
                        <canvas id="chart-mul-bad"></canvas>
                        <div class="svg-label bad">Redundant (Bad)</div>
                    </div>
                </div>
                <p><strong>The Rule (Analogy):</strong> Do not use two inputs that measure the same thing.</p>
                <p><strong>The Bookish Definition (Formal):</strong> No independent variable is a perfect linear
                    combination of other independent variables.</p>
                <div class="note tip" style="margin-top:8px; font-size:0.9rem;">
                    <strong>Exam Result:</strong> If you violate this, your coefficient standard errors will be
                    <strong>Inflated</strong> (Too High), making T-stats <strong>Too Low</strong> (Insignificant).
                </div>
            </div>
            <div class="note warn">
                <div class="note-title">‚ö†Ô∏è Important</div>
                <p>Violations don't make the model useless ‚Äî they affect the <strong>reliability of tests and
                        inferences</strong>. You'll learn how to fix them in LM3.</p>
            </div>

            <h3>Vocabulary Alert</h3>
            <div class="card">
                <ul>
                    <li><span class="hl-green">Homoskedasticity</span> = GOOD (constant variance)</li>
                    <li><span class="hl-pink">Heteroskedasticity</span> = BAD (changing variance)</li>
                </ul>
            </div>
        </section>

        <!-- DIAGNOSTICS -->
        <section class="section" id="diagnostics">
            <h2>üìä Diagnostic Charts</h2>

            <p>The exam shows you charts and asks: "Is the model okay?" Here's how to read them:</p>

            <h3>1. Scatterplot Matrix (Pairwise Plots)</h3>
            <div class="card">
                <p><strong>Shows:</strong> Relationship between every pair of variables</p>
                <p><strong>Check $Y$ vs $X$:</strong> Should be linear (straight cloud). Curved = violation of
                    Linearity.</p>
                <p><strong>Check $X$ vs $X$:</strong> Should be random blob. Perfect line = Multicollinearity.</p>
            </div>

            <h3>2. Residuals vs. Predicted Values</h3>
            <div class="note tip">
                <div class="note-title">üéØ The "Target Practice" Analogy</div>
                <p>Think of your model as an archer. The "Predicted Value" is how far the target is.</p>
                <ul>
                    <li><strong>Homoskedastic (Good):</strong> Whether the target is close (10m) or far (100m), your
                        accuracy is the same. Your arrows cluster tightly around the bullseye.</li>
                    <li><strong>Heteroskedastic (Bad):</strong> As the target gets further away, your aim gets shaky.
                        The arrows spread out wildly. This "fanning out" means you can't trust long-range predictions.
                    </li>
                </ul>
            </div>
            <div class="svg-container">
                <div class="svg-card">
                    <svg viewBox="0 0 100 80">
                        <line x1="0" y1="40" x2="100" y2="40" stroke="#E8E4E0" stroke-width="1" />
                        <circle cx="10" cy="35" r="2" fill="#00B894" />
                        <circle cx="15" cy="45" r="2" fill="#00B894" />
                        <circle cx="30" cy="38" r="2" fill="#00B894" />
                        <circle cx="50" cy="42" r="2" fill="#00B894" />
                        <circle cx="70" cy="36" r="2" fill="#00B894" />
                        <circle cx="90" cy="44" r="2" fill="#00B894" />
                    </svg>
                    <div class="svg-label good">Homoskedastic (Good)</div>
                </div>
                <div class="svg-card">
                    <svg viewBox="0 0 100 80">
                        <line x1="0" y1="40" x2="100" y2="40" stroke="#E8E4E0" stroke-width="1" />
                        <circle cx="10" cy="39" r="1.5" fill="#FF4B2B" />
                        <circle cx="15" cy="41" r="1.5" fill="#FF4B2B" />
                        <circle cx="40" cy="35" r="2" fill="#FF4B2B" />
                        <circle cx="40" cy="45" r="2" fill="#FF4B2B" />
                        <circle cx="80" cy="20" r="3" fill="#FF4B2B" />
                        <circle cx="80" cy="60" r="3" fill="#FF4B2B" />
                    </svg>
                    <div class="svg-label bad">Funnel Shape (Bad)</div>
                </div>
            </div>

            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>Shape</th>
                            <th>Meaning</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Shape">‚úÖ Random cloud</td>
                            <td data-label="Meaning">Assumptions OK</td>
                        </tr>
                        <tr>
                            <td data-label="Shape">‚ùå Funnel shape</td>
                            <td data-label="Meaning">Heteroskedasticity</td>
                        </tr>
                        <tr>
                            <td data-label="Shape">‚ùå U-shape</td>
                            <td data-label="Meaning">Non-linearity</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>3. Residuals vs. Independent Variable</h3>
            <div class="card">
                <p><strong>Shows:</strong> Errors plotted against one specific $X$</p>
                <p><strong>Look for:</strong> Patterns or curves ‚Üí that specific $X$ may need transformation (e.g.,
                    $X^2$)</p>
            </div>

            <h3>4. Normal Q-Q Plot</h3>
            <div class="note tip">
                <div class="note-title">üìè The "Perfect Lineup" Analogy</div>
                <p>Imagine lining up everyone in strict height order. Then you compare them to a "theoretical average
                    human lineup."</p>
                <ul>
                    <li>If they match perfectly, they stand on the the diagonal line.</li>
                    <li>If you have <strong>Fat Tails</strong>, it means your shortest people are WAY shorter than
                        expected, and your tallest are WAY taller. They "peel off" the line at the ends. This signals
                        extreme risk.</li>
                </ul>
            </div>
            <div class="svg-container">
                <div class="svg-card">
                    <svg viewBox="0 0 100 80">
                        <line x1="10" y1="70" x2="90" y2="10" stroke="#00B894" stroke-width="1" stroke-dasharray="2" />
                        <circle cx="15" cy="65" r="2" fill="#555" />
                        <circle cx="30" cy="50" r="2" fill="#555" />
                        <circle cx="50" cy="40" r="2" fill="#555" />
                        <circle cx="70" cy="30" r="2" fill="#555" />
                        <circle cx="85" cy="15" r="2" fill="#555" />
                    </svg>
                    <div class="svg-label good">Normal (Good)</div>
                </div>
                <div class="svg-card">
                    <svg viewBox="0 0 100 80">
                        <line x1="10" y1="70" x2="90" y2="10" stroke="#ccc" stroke-width="1" stroke-dasharray="2" />
                        <path d="M10,60 Q30,50 50,40 T90,20" fill="none" stroke="#FF4B2B" stroke-width="2" />
                    </svg>
                    <div class="svg-label bad">Fat Tails (Bad)</div>
                </div>
            </div>
            <div class="card">
                <p><strong>Shows:</strong> How residuals compare to a perfect normal distribution</p>
                <table>
                    <tr>
                        <th>Shape</th>
                        <th>Meaning</th>
                    </tr>
                    <tr>
                        <td>‚úÖ Dots hug diagonal line</td>
                        <td>Residuals are normal</td>
                    </tr>
                    <tr>
                        <td>‚ùå Dots peel off at ends</td>
                        <td>Fat Tails (extreme outliers more common)</td>
                    </tr>
                </table>
            </div>

            <div class="exam-tip">
                <strong>Chart Summary:</strong><br>
                ‚Ä¢ Scatterplot ‚Üí Check Linearity & Multicollinearity<br>
                ‚Ä¢ Residuals vs Predicted ‚Üí Check Homoskedasticity<br>
                ‚Ä¢ Q-Q Plot ‚Üí Check Normality
            </div>
        </section>

        <!-- OUTPUT -->
        <section class="section" id="output">
            <h2>üìã Reading Regression Output</h2>

            <p>Regression software (Excel, Python) spits out a "Scorecard" for your model. Here is how to grade it,
                step-by-step.</p>

            <h3>1. The "Accuracy" Score: R-Squared ($R^2$)</h3>
            <div class="formula-box">
                <div class="label">R-Squared</div>
                <div class="formula">$$R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}$$</div>
                <div class="desc">% of $Y$'s variation explained by the model</div>
            </div>

            <div class="note info">
                <div class="note-title">Analogy</div>
                <p>Think of $R^2$ as a test score grade from 0 to 100%.</p>
                <p>If $R^2 = 0.10$, your model explains only 10% of the movement in stock prices (it's basically
                    guessing).</p>
                <p>If $R^2 = 0.85$, your model is capturing 85% of the story. That's an "A" grade.</p>
                <p><strong>BUT BEWARE:</strong> You can cheat to get a higher score by adding useless variables.
                    <strong>Adjusted $R^2$</strong> is the teacher correcting your grade to penalize cheating.
                </p>
            </div>

            <h3>2. The "Pass/Fail" Test: F-Statistic</h3>
            <div class="card">
                <p><strong>The Question:</strong> "Is this entire model garbage?"</p>
                <p>Sometimes, a model has 5 variables, and individually none of them look great. The F-test checks if
                    they work <em>together</em> as a team to explain something.</p>
                <p><strong>Rule:</strong> Look at the <strong>Significance F</strong> (p-value).</p>
                <ul>
                    <li>Is it < 0.05? <strong>PASS</strong>. The model works.</li>
                    <li>Is it > 0.05? <strong>FAIL</strong>. The whole model is useless.</li>
                </ul>
            </div>

            <h3>3. The "Trust" Test: t-Statistic</h3>
            <div class="card">
                <p><strong>The Question:</strong> "Can I trust <em>this specific variable</em>, or is it just lucky
                    noise?"</p>
                <p>You check this for each individual coefficient (Slope).</p>
                <div class="flow-diagram" style="margin: 10px 0;">
                    <div class="flow-step"><span class="flow-num">?</span><span class="flow-text">Check Absolute t-stat
                            ($|t|$)</span></div>
                    <div class="flow-step"><span class="flow-num">&gt;2</span><span
                            class="flow-text"><strong>Significant.</strong> The variable matters.</span></div>
                    <div class="flow-step"><span class="flow-num">&lt;2</span><span class="flow-text"><strong>Not
                                Significant.</strong> It's just noise. Ignore
                            it.</span></div>
                </div>
                <p><em>Example:</em> If "GDP Growth" has a t-stat of 0.5, it means GDP Growth doesn't actually predict
                    stock returns in your model. It's statistically zero.</p>
            </div>
            <h3>4. Standard Error of Estimate (SEE)</h3>
            <div class="formula-box">
                <div class="label">SEE</div>
                <div class="formula">$$SEE = \sqrt{\frac{SSE}{n-k-1}}$$</div>
                <div class="desc">Average prediction error (lower = better)</div>
            </div>

            <h3>Reading the ANOVA Table (The "Scorecard")</h3>
            <p>The exam will give you a scary looking table called "ANOVA" (Analysis of Variance). It's just a scorecard
                telling you where the volatility in your data comes from.</p>

            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Source</th>
                            <th>What it means in plain English</th>
                            <th>Formula Symbol</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Measure">SST</td>
                            <td data-label="Meaning">Total variation (Total)</td>
                        </tr>
                        <tr>
                            <td data-label="Measure">SSR</td>
                            <td data-label="Meaning">Explained by model (Regression)</td>
                        </tr>
                        <tr>
                            <td data-label="Measure">SSE</td>
                            <td data-label="Meaning">Unexplained noise (Residual)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="formula-box">
                <div class="label">Key Identity</div>
                <div class="formula">$$SST = SSR + SSE$$</div>
                <div class="desc">Total = Explained + Unexplained</div>
            </div>
        </section>

        <!-- TRAPS -->
        <section class="section" id="traps">
            <h2>‚ö†Ô∏è Exam Traps</h2>

            <div class="trap">
                <strong>Trap 1: Missing "Holding Constant"</strong><br>
                If a question asks to interpret $\beta_1$, scan answers for "holding all other variables constant."
                Answers without this phrase are usually WRONG.
            </div>

            <div class="trap">
                <strong>Trap 2: Correlation ‚â† Causation</strong><br>
                Just because $X$ is significant doesn't mean $X$ <em>causes</em> $Y$. They just move together.
            </div>

            <div class="trap">
                <strong>Trap 3: Binary Dependent Variable</strong><br>
                If $Y$ is Yes/No, 0/1, Bankrupt/Not ‚Üí Use <strong>Logistic Regression</strong>, NOT Linear.
            </div>

            <div class="trap">
                <strong>Trap 4: Chart Misinterpretation</strong><br>
                ‚Ä¢ Funnel shape = Heteroskedasticity (variance problem)<br>
                ‚Ä¢ U-shape = Non-linearity (model misspecification)<br>
                ‚Ä¢ Q-Q tail deviation = Fat tails (non-normal residuals)
            </div>

            <div class="trap">
                <strong>Trap 5: Outliers</strong><br>
                Look for "lonely dots" far from the pack in any chart. Outliers can tilt the regression line and distort
                results.
            </div>

            <h3>Quick Decision Guide</h3>
            <td>Q-Q plot peels off at ends</td>
            <td>Fat Tails (Non-Normal)</td>
            </tr>
            <tr>
                <td>Residuals over time show waves</td>
                <td>Serial Correlation</td>
            </tr>
            </table>
            </div>

            <div class="exam-tip">
                <strong>Memory Trick for df:</strong><br>
                ‚Ä¢ $n$ = observations<br>
                ‚Ä¢ $k$ = independent variables<br>
                ‚Ä¢ $k + 1$ = total parameters (including intercept)<br>
                ‚Ä¢ $n - k - 1$ = degrees of freedom for error
            </div>
        </section>

    </main>

    <div class="footer-spacer"></div>

    <script>
        // Navigation Active State - REMOVED (Not needed for Tabbed Interface)
        const sections = document.querySelectorAll('.section');


        // Pill Navigation Logic
        const pills = document.querySelectorAll('.nav-pill');

        pills.forEach(pill => {
            pill.addEventListener('click', () => {
                const targetId = pill.dataset.section;
                pills.forEach(p => p.classList.remove('active'));
                pill.classList.add('active');

                // 1. Hide all sections
                sections.forEach(s => s.classList.remove('active'));

                // 2. Show target section
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.classList.add('active');
                    // 3. Scroll to top
                    window.scrollTo({ top: 0, behavior: 'instant' });
                }
            });
        });

        // Chart.js Implementations for Assumptions
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                x: { grid: { display: false }, ticks: { display: false } },
                y: { grid: { display: false }, ticks: { display: false } }
            },
            animation: { duration: 1500, easing: 'easeOutQuart' }
        };

        const createChart = (ctxId, type, data, options = {}) => {
            const ctx = document.getElementById(ctxId).getContext('2d');
            return new Chart(ctx, {
                type: type,
                data: data,
                options: { ...commonOptions, ...options }
            });
        };

        // 1. Linearity Data
        const linGoodData = Array.from({ length: 20 }, (_, i) => ({ x: i, y: 10 + 2 * i + (Math.random() * 4 - 2) }));
        const linBadData = Array.from({ length: 20 }, (_, i) => ({ x: i, y: 50 - 2 * i + 0.15 * i * i + (Math.random() * 4 - 2) }));

        createChart('chart-lin-good', 'scatter', {
            datasets: [{ data: linGoodData, backgroundColor: '#00B894', pointRadius: 4 }]
        });
        createChart('chart-lin-bad', 'scatter', {
            datasets: [{ data: linBadData, backgroundColor: '#FF4B2B', pointRadius: 4 }]
        });

        // 2. Homoskedasticity Data
        const homGoodData = Array.from({ length: 30 }, (_, i) => ({ x: i, y: 20 + (Math.random() * 10 - 5) }));
        const homBadData = Array.from({ length: 30 }, (_, i) => ({ x: i, y: 20 + (Math.random() * (i + 5) - (i + 5) / 2) }));

        createChart('chart-hom-good', 'scatter', {
            datasets: [{ data: homGoodData, backgroundColor: '#00B894', pointRadius: 4 }]
        });
        createChart('chart-hom-bad', 'scatter', {
            datasets: [{ data: homBadData, backgroundColor: '#FF4B2B', pointRadius: 4 }]
        });

        // 3. Independence Data (Line Chart)
        const indGoodData = Array.from({ length: 20 }, (_, i) => Math.random() * 10 - 5);
        const indBadData = Array.from({ length: 20 }, (_, i) => Math.sin(i / 3) * 8 + Math.random() * 2);

        createChart('chart-ind-good', 'line', {
            labels: Array.from({ length: 20 }, (_, i) => i),
            datasets: [{ data: indGoodData, borderColor: '#00B894', borderWidth: 2, pointRadius: 0, tension: 0.4 }]
        });
        createChart('chart-ind-bad', 'line', {
            labels: Array.from({ length: 20 }, (_, i) => i),
            datasets: [{ data: indBadData, borderColor: '#FF4B2B', borderWidth: 2, pointRadius: 0, tension: 0.4 }]
        });

        // 4. Normality Data (Bar/Bell)
        try {
            createChart('chart-norm-good', 'bar', {
                labels: [-3, -2, -1, 0, 1, 2, 3],
                datasets: [{ data: [2, 10, 25, 40, 25, 10, 2], backgroundColor: '#00B894', borderRadius: 4 }]
            });
            createChart('chart-norm-bad', 'bar', {
                labels: [-3, -2, -1, 0, 1, 2, 3],
                datasets: [{ data: [15, 5, 5, 50, 5, 5, 15], backgroundColor: '#FF4B2B', borderRadius: 4 }]
            });
        } catch (e) { console.error("Normality chart error", e); }


        // 5. Multicollinearity (Scatter X1 vs X2)
        const mulGoodData = Array.from({ length: 20 }, () => ({ x: Math.random() * 10, y: Math.random() * 10 }));
        const mulBadData = Array.from({ length: 20 }, (_, i) => ({ x: i + Math.random(), y: i + Math.random() }));

        createChart('chart-mul-good', 'scatter', {
            datasets: [{ data: mulGoodData, backgroundColor: '#00B894', pointRadius: 4 }]
        });
        createChart('chart-mul-bad', 'scatter', {
            datasets: [{ data: mulBadData, backgroundColor: '#FF4B2B', pointRadius: 4 }]
        });

    </script>
    <script>
        // --- PRACTICE SECTION LOGIC ---

        // 1. Practice Charts (Recreating Exam Visuals)

        // Chart 1: RET vs VIX (Curved/Quadratic - Violation of Linearity)
        const retVixData = Array.from({ length: 40 }, () => {
            const x = Math.random() * 160 - 60; // -60 to 100
            const y = 0.005 * x * x - 20 + (Math.random() * 10 - 5); // Parabola + Noise
            return { x, y };
        });
        createChart('chart-prac-1', 'scatter', {
            datasets: [{
                label: 'RET vs VIX',
                data: retVixData,
                backgroundColor: '#FF4B2B' // Red to hint at problem
            }],
            options: {
                plugins: { title: { display: true, text: 'Chart 1: RET vs VIX (Curved?)' } }
            }
        });

        // Chart 2: RET vs MRKT (Linear - Good)
        const retMrktData = Array.from({ length: 40 }, () => {
            const x = Math.random() * 30 - 15;
            const y = 1.2 * x + (Math.random() * 5 - 2.5);
            return { x, y };
        });
        createChart('chart-prac-2', 'scatter', {
            datasets: [{ data: retMrktData, backgroundColor: '#00B894' }]
        });

        // Chart 3: MRKT vs HML (Independence Check)
        const mrktHmlData = Array.from({ length: 40 }, () => ({
            x: Math.random() * 30 - 15,
            y: Math.random() * 20 - 10
        }));
        createChart('chart-prac-3', 'scatter', {
            datasets: [{ data: mrktHmlData, backgroundColor: '#555' }]
        });

        // Chart 4: Residuals vs Predicted (Homoskedasticity Check)
        const resPredData = Array.from({ length: 40 }, () => ({
            x: Math.random() * 60 - 30,
            y: Math.random() * 20 - 10 // Constant variance
        }));
        createChart('chart-prac-4', 'scatter', {
            datasets: [{ data: resPredData, backgroundColor: '#555' }]
        });


        // 2. Quiz System
        const questions = [
            {
                q: "1. Determine the type of regression model you should use.",
                options: ["Logistic regression", "Simple linear regression", "Multiple linear regression"],
                correct: 2,
                expl: "Dependent variable (Returns) is continuous, and there are 3 distinct independent variables."
            },
            {
                q: "2. Interpret the VIX coefficient (0.037).",
                options: [
                    "1% increase in VIX -> -0.962% decrease in RET",
                    "0.037% increase in VIX -> 1.0% increase in RET",
                    "1% increase in VIX, holding others constant -> 0.037% increase in RET"
                ],
                correct: 2,
                expl: "Always look for 'holding all other variables constant'. The coefficient 0.037 means a 1 unit increase in X leads to 0.037 increase in Y."
            },
            {
                q: "3. Identify the assumption violation in Chart 1 (RET vs VIX).",
                options: ["Independence of errors", "Independence of independent variables", "Linearity"],
                correct: 2,
                expl: "Chart 1 shows a U-shape (Curve). Linear regression assumes a straight line. This is a linearity violation."
            },
            {
                q: "4. Which chart assesses Homoskedasticity?",
                options: ["Chart 2", "Chart 3 (MRKT vs HML)", "Chart 4 (Residuals vs Predicted)"],
                correct: 2,
                expl: "Homoskedasticity is about the *Variance of Errors*. You check this with Residuals vs Predicted Values (Chart 4)."
            },
            {
                q: "5. Which chart assesses Multicollinearity (Independence of X)?",
                options: ["Chart 2", "Chart 3 (MRKT vs HML)", "Chart 4"],
                correct: 1,
                expl: "Multicollinearity is about X variables being related to each other. Chart 3 compares two X's (MRKT vs HML)."
            }
        ];

        const quizContainer = document.getElementById('quiz-container');

        questions.forEach((q, idx) => {
            const qEl = document.createElement('div');
            qEl.className = 'card';
            qEl.innerHTML = `
                <h4>${q.q}</h4>
                <div class="options" style="display:flex; flex-direction:column; gap:8px;">
                    ${q.options.map((opt, i) => `
                        <button class="nav-pill" style="text-align:left; width:100%;" onclick="checkAnswer(this, ${idx}, ${i})">
                            ${String.fromCharCode(65 + i)}. ${opt}
                        </button>
                    `).join('')}
                </div>
                <div id="res-${idx}" class="note" style="display:none; margin-top:10px;"></div>
            `;
            quizContainer.appendChild(qEl);
        });

        let score = 0;
        const attempts = new Set();

        window.checkAnswer = (btn, qIdx, optIdx) => {
            const q = questions[qIdx];
            const resEl = document.getElementById(`res-${qIdx}`);
            const parent = btn.parentElement;

            // Disable all buttons in this question
            Array.from(parent.children).forEach(b => b.disabled = true);

            if (optIdx === q.correct) {
                btn.style.background = '#00B894'; // Green
                btn.style.color = 'white';
                resEl.className = 'note hint';
                resEl.innerHTML = `<strong>‚úÖ Correct!</strong> ${q.expl}`;
                if (!attempts.has(qIdx)) score++;
            } else {
                btn.style.background = '#FF4B2B'; // Red
                btn.style.color = 'white';
                resEl.className = 'note warn';
                resEl.innerHTML = `<strong>‚ùå Incorrect.</strong> ${q.expl}`;
                // Highlight correct
                parent.children[q.correct].style.background = '#00B894';
                parent.children[q.correct].style.color = 'white';
            }
            attempts.add(qIdx);
            resEl.style.display = 'block';

            // Update Score
            if (attempts.size === questions.length) {
                const sCard = document.getElementById('score-card');
                sCard.style.display = 'block';
                sCard.innerHTML = `<strong>Final Score: ${score} / 5</strong>`;
                sCard.scrollIntoView({ behavior: 'smooth' });
            }
        };

    </script>
</body>

</html>